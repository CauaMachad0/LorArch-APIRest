<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout :: template(~{::title}, ~{::main})}">
<head>
    <meta charset="UTF-8">
    <title th:text="${ocorrencia.id} != null ? 'Editar Ocorrência' : 'Nova Ocorrência'">Ocorrência</title>
</head>
<body>
<main>
    <h1 th:text="${ocorrencia.id} != null ? 'Editar Ocorrência' : 'Nova Ocorrência'">Ocorrência</h1>

    <div th:if="${#fields.hasErrors('*')}" style="color:red; margin-bottom:8px;">
        <p th:each="e : ${#fields.errors('*')}" th:text="${e}">Erro</p>
    </div>

    <form th:object="${ocorrencia}" th:action="${action}" method="post">
        <input th:if="${ocorrencia.id != null}" type="hidden" name="_method" value="put"/>
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

        <div>
            <label>Tipo</label><br>
            <select th:field="*{tipo}" required>
                <option value="">-- selecione --</option>
                <option value="ENTRADA">Entrada</option>
                <option value="SAIDA">Saída</option>
                <option value="MANUTENCAO">Manutenção</option>
                <option value="DIAGNOSTICO">Diagnóstico</option>
            </select>
            <div th:if="${#fields.hasErrors('tipo')}" th:errors="*{tipo}" style="color:red;"></div>
        </div>

        <div>
            <label>Descrição</label><br>
            <textarea th:field="*{descricao}" rows="3" cols="40" maxlength="255" required></textarea>
            <div th:if="${#fields.hasErrors('descricao')}" th:errors="*{descricao}" style="color:red;"></div>
        </div>

        <div>
            <label>Data</label><br>
            <input type="date" th:field="*{data}" required/>
            <div th:if="${#fields.hasErrors('data')}" th:errors="*{data}" style="color:red;"></div>
        </div>

        <div>
            <label>Custo</label><br>
            <input type="number" step="0.01" min="0" th:field="*{custo}" required/>
            <div th:if="${#fields.hasErrors('custo')}" th:errors="*{custo}" style="color:red;"></div>
        </div>

        <div>
            <label>Moto</label><br>
            <select th:field="*{motoId}" required>
                <option value="">-- selecione --</option>
                <option th:each="m : ${motos}" th:value="${m.id}" th:text="${m.placa}">ABC1D23</option>
            </select>
            <div th:if="${#fields.hasErrors('motoId')}" th:errors="*{motoId}" style="color:red;"></div>
        </div>

        <div>
            <label>Setor</label><br>
            <select th:field="*{setorId}" required>
                <option value="">-- selecione --</option>
                <option th:each="s : ${setores}" th:value="${s.id}" th:text="${s.nome}">Operações</option>
            </select>
            <div th:if="${#fields.hasErrors('setorId')}" th:errors="*{setorId}" style="color:red;"></div>
        </div>

        <div style="margin-top:10px;">
            <button type="submit">Salvar</button>
            <a th:href="@{/ocorrencias}">Cancelar</a>
        </div>
    </form>
</main>
</body>
</html>
